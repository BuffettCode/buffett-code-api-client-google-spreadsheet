<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <script>
      function onError(e) {
        console.error(e.message, e.stack)
        alert('エラーが発生しました。')
      }

      function exportCsv() {
        const ticker = document.getElementById('ticker-input').value
        const from = document.getElementById('from-input').value
        const to = document.getElementById('to-input').value

        google.script.run
          .withFailureHandler(onError)
          .withSuccessHandler(() => {
            alert('出力が完了しました')
          })
          .exportCsv(ticker, from, to)
      }
    </script>
  </head>
  <body>
    <div class="sidebar">
      <div class="block form-group">
        <label for="ticker-input"><b>銘柄コード</b></label>
        <input id="ticker-input" type="text" style="width: 65px;">
      </div>

      <div class="block form-group inline">
        <label for="from-input"><b>期間</b></label>
        <input id="from-input" type="text" style="width: 65px;">
      </div>
      <div class="inline">
        〜
      </div>
      <div class="block inline">
        <input id="to-input" type="text" style="width: 65px;">
      </div>

      <div class="block">
        <b>出力先</b>
      </div>
      <div class="block inline" style="margin-top: 0;">
        <input type="radio" id="csv-export-current-sheet" checked>
        <label for="csv-export-current-sheet">新しいシート</label>
      </div>

      <div class="block">
        <button class="action" onclick="exportCsv()">出力</button>
        <button onclick="google.script.host.close()">キャンセル</button>
      </div>
    </div>
  </body>
</html>
